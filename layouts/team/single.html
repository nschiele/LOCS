{{ define "content" }}

<style>
  .avatar-user {
    background-size: cover;
    background-position: 50% 50%;
    background-repeat: no-repeat;
    width: 260px !important;
    height: 260px !important;
  }
</style>

<div class="container-xl px-3 px-md-4 px-lg-5 mt-4">
  <div class="gutter-condensed gutter-lg flex-column flex-md-row d-flex">
    <div class="flex-shrink-0 col-12 col-md-3 mb-4 mb-md-0">
      <div class="h-card mt-md-2">
        <div class="user-profile-sticky-bar js-user-profile-sticky-bar d-none d-md-block">
          <div class="user-profile-mini-vcard d-table">
            {{ if .Params.img }}
            <span class="user-profile-mini-avatar d-table-cell v-align-middle lh-condensed-ultra pr-2" class="rounded-1 avatar-user" style="background-image:url({{ .Params.img }})">
            </span>
            {{ end }}
            <span class="d-table-cell v-align-middle lh-condensed">
              <strong>{{ .Params.firstname }} {{ .Params.lastname }}</strong>
            </span>
          </div>
        </div>
        <div class="clearfix d-flex d-md-block flex-items-center mb-4 mb-md-0">
          <div class="position-relative d-inline-block col-2 col-md-12 mr-3 mr-md-0 flex-shrink-0">
            {{ if .Params.img }}
            <div class="avatar avatar-user width-full border bg-white" style="background-image:url({{ .Params.img }})">
            </div>

            {{ else }}
            <div class="user-profile-mini-avatar d-table-cell v-align-middle lh-condensed-ultra pr-2" class="rounded-1 avatar-user" style="background-image:url('/images/default-avatar.png')">
            </div>
            {{ end }}
          </div>
          <div class="vcard-names-container float-left col-10 col-md-12 pt-1 pt-md-3 pb-1 pb-md-3 js-sticky js-user-profile-sticky-fields">
            <h1 class="vcard-names pl-2 pl-md-0">
              <span class="p-name vcard-fullname d-block overflow-hidden">{{ .Params.firstname }} {{ .Params.lastname }}</span>
            </h1>
            <h2 class="vcard-username d-block pl-2 pl-md-0">{{ .Params.position }}</h2>
          </div>
        </div>
        <div class="p-note user-profile-bio mb-3">
          <div class="d-flex flex-column">
            {{ if .Params.github }}
            <a href="https://github.com/{{ .Params.github }}" class="Link--muted mb-2">
              <svg class="octicon octicon-mark-github v-align-middle mr-2" height="16" viewBox="0 0 16 16" width="16">
                <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path>
              </svg>
              GitHub
            </a>
            {{ end }}
            {{ if .Params.gscholar }}
            <a href="https://scholar.google.com/citations?user={{ .Params.gscholar }}" class="Link--muted mb-2">
              <img src="/images/scholar.png" alt="Google Scholar" width="20" class="octicon octicon-mark-github v-align-middle mr-1" style="opacity: 0.7;">
              Google Scholar
            </a>
            {{ end }}
            {{ if .Params.linkedin }}
            <a href="https://linkedin.com/in/{{ .Params.linkedin }}" class="Link--muted mb-2">
              <svg height="16" viewBox="0 0 16 16" width="16" class="octicon mr-2">
                <path d="M14.5 0h-13C.675 0 0 .675 0 1.5v13c0 .825.675 1.5 1.5 1.5h13c.825 0 1.5-.675 1.5-1.5v-13c0-.825-.675-1.5-1.5-1.5zM5 13H3V6h2v7zM4 5c-.553 0-1-.447-1-1s.447-1 1-1 1 .447 1 1-.447 1-1 1zm9 8h-2V9.5c0-.553-.447-1-1-1s-1 .447-1 1V13h-2V6h2v1.5c.419-.625 1.002-1.5 2.5-1.5 1.378 0 2.5 1.122 2.5 2.5V13z"/>
              </svg>
              LinkedIn
            </a>
            {{ end }}

            {{ if .Params.lu_email }}
            <a href="mailto:{{ .Params.lu_email }}@liacs.leidenuniv.nl" class="Link--muted mb-2">

              <svg height="16" viewBox="0 0 16 16" width="16" class="octicon mr-2">
                <path d="M1.75 2h12.5c.966 0 1.75.784 1.75 1.75v8.5A1.75 1.75 0 0 1 14.25 14H1.75A1.75 1.75 0 0 1 0 12.25v-8.5C0 2.784.784 2 1.75 2ZM1.5 12.251c0 .138.112.25.25.25h12.5a.25.25 0 0 0 .25-.25V5.809L8.38 9.397a.75.75 0 0 1-.76 0L1.5 5.809v6.442Zm13-8.181v-.32a.25.25 0 0 0-.25-.25H1.75a.25.25 0 0 0-.25.25v.32L8 7.88Z"></path>
              </svg>
              {{ .Params.lu_email }}@liacs.leidenuniv.nl
            </a>
            {{ end }}



          </div>
        </div>
      </div>
    </div>

    <div class="flex-shrink-0 col-12 col-md-9 mb-4 mb-md-0">
      <div class="UnderlineNav width-full box-shadow-none">
        <div class="UnderlineNav-body">
          <a class="UnderlineNav-item selected" href="#" aria-current="page">
            Overview
          </a>
        </div>
      </div>
      
      <div class="Box mt-4">
        <div class="Box-body p-4">
          {{ .Content }}

          <!-- Publications Section -->
          {{ $authorName := printf "%s %s" .Params.firstname .Params.lastname }}
          {{ $lastName := .Params.lastname }}
          {{ $publications := where .Site.RegularPages "Section" "publication" }}
          {{ $authorPubsByName := where $publications "Params.authors" "intersect" (slice $authorName) }}
          {{ $authorPubsByLastName := where $publications "Params.authors" "intersect" (slice $lastName) }}
          {{ $authorPubs := union $authorPubsByName $authorPubsByLastName }}
          {{ if $authorPubs }}
          <h2 class="mb-3">Publications</h2>
          <div class="mb-4">
            {{ range $authorPubs }}
              <div class="mb-3">
                <a href="{{ .Params.doi }}">{{ .Title }}</a>
                {{- if .Params.authors -}}
                  <div style="color:#535c66">
                  {{- range $i, $author := .Params.authors -}}
                    {{- if ne $i 0 -}},&nbsp;{{- end -}}
                    {{ $linked := false }}
                    {{ $authorLower := lower $author }}
                    {{/* Try to find team member by lastname match */}}
                    {{ range where $.Site.RegularPages "Section" "team" }}
                        {{ $teamLastname := lower .Params.lastname }}
                        {{ if eq $teamLastname $authorLower }}
                            <a href="{{ .RelPermalink }}" style="color:#535c66">{{ .Params.firstname }} {{ .Params.lastname }}</a>
                            {{ $linked = true }}
                            {{ break }}
                        {{ end }}
                    {{ end }}
                    {{/* If no match found, display as plain text */}}
                    {{ if not $linked }}{{ $author }}{{ end }}
                  {{- end -}}
                {{- end -}}
                  </div>
              </div>
            {{ end }}
          </div>
          {{ end }}

          <!-- Theses Section -->
          {{ $theses := where .Site.RegularPages "Section" "theses" }}
          {{ $thesesByName := where $theses "Params.supervisors" "intersect" (slice $authorName) }}
          {{ $thesesByLastName := where $theses "Params.supervisors" "intersect" (slice $lastName) }}
          {{ $supervisedTheses := union $thesesByName $thesesByLastName }}
          {{ if $supervisedTheses }}
          <h2 class="mb-3">Supervised Theses</h2>
          <div class="mb-4">
            {{ range $supervisedTheses }}
              <div class="mb-3">
                <a href="{{ .RelPermalink }}">{{ .Title }}</a>
              </div>
            {{ end }}
          </div>
          {{ end }}
        </div>
      </div>
    </div>
  </div>
</div>
{{ end }}